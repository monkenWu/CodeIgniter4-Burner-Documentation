<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>OpenSwoole suggestions</title>
    <meta name="description" content="Documentation for CodeIgniter4 Burner v1.0.0">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Source+Sans+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/en/assets/normalize.css?v=1679820075"
        media="screen" />
    <link rel="stylesheet" type="text/css" href="/en/assets/doctave-style.css?v=1679820075"
        media="screen" />
    <link rel="stylesheet" type="text/css" href="/en/assets/katex.css?v=1679820075" media="screen" />
    <link rel="stylesheet" type="text/css" href="/en/assets/prism-ghcolors.css?v=1679820075"
        media="screen" />

    <script>
        var DOCTAVE_TIMESTAMP = "1679820075";
        var BASE_PATH = "/en/";
        var color = localStorage.getItem('doctave-color')

        if (color === 'dark') {
            document.getElementsByTagName('html')[0].classList.remove('light');
            document.getElementsByTagName('html')[0].classList.add('dark');
        } else {
            document.getElementsByTagName('html')[0].classList.remove('dark');
            document.getElementsByTagName('html')[0].classList.add('light');
        }
    </script>

    
    <link rel="icon" type="image/x-icon" href="/favicon.ico"> 
<script>
    document.title = 'CodeIgniter4 Burner - ' + document.title;
</script>
    
</head>

<body>
    <label for='menu-toggle-switch' class='menu-toggle-button'>
        â˜°
    </label>
    <input type="checkbox" id="menu-toggle-switch" value='0' />
    <div class='page'>
        <div class='header'>
            <div class='logo'>
                
                <a href="/en/">
                    <img src="/en/logo.png" alt='CodeIgniter4 Burner v1.0.0 logo'></img>
                </a>
                
                <h2 class='project-name'>
                    <a href="/en/">
                        CodeIgniter4 Burner v1.0.0
                    </a>
                </h2>
            </div>
            <div class='search'>
                <form id='search-form'>
    <input type='text' id='search-box' autocomplete="off" placeholder="Search..."></input>
    <span class='search-icon'>S</span>
    <ul id='search-results'></ul>
</form>

            </div>
            <div class='header-dummy-right'>
            </div>
        </div>
        <div class='container'>
            <div class='sidebar-left'>
                <nav class='site-nav'>
    <ul>
        
            <li><a href="/en/introduction">Welcome to Burner!</a></li>
            
        
            <li><a href="/en/general">General</a></li>
            
                <ul>
    
        <li><a href="/en/general/quickstart">Quickstart</a></li>
        
    
        <li><a href="/en/general/suggestion">Development Suggestion</a></li>
        
    
        <li><a href="/en/general/docker">Docker Environment</a></li>
        
    
</ul>

            
        
            <li><a href="/en/openswoole">OpenSwoole</a></li>
            
                <ul>
    
        <li><a href="/en/openswoole/implement">OpenSwoole Implement</a></li>
        
    
        <li><a class="active" href="/en/openswoole/suggestion">OpenSwoole suggestions</a></li>
        
    
        <li><a href="/en/openswoole/commands">OpenSwoole Commands</a></li>
        
    
</ul>

            
        
    </ul>
    <span id='light-dark-mode-switch'>
        <svg xmlns="http://www.w3.org/2000/svg" id="dark-mode-icon" viewBox="0 0 20 20" fill="currentColor">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
        </svg>

        <svg xmlns="http://www.w3.org/2000/svg" id="light-mode-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" />
        </svg>
    </span>
</nav>

            </div>
            <div class='doctave-content'>
                <h1 id="openswoole-suggestions">OpenSwoole suggestions</h1>
<h2 id="fast-cache">Fast Cache</h2>
<p>OpenSwoole provides a fast cache system that can be shared between multiple workers and synchronized between multiple workers. We support <a href="https://openswoole.com/docs/modules/swoole-table">Swoole-Table</a> as the storage interface for the cache, which you can use in your project just like you are familiar with!</p>
<p>You can add the following settings in the <code>app/Config/OpenSwoole.php</code> configuration file and restart the server.</p>
<pre><code class="language-php">/**
 * Whether to open the Key/Value Cache provided by Burner.
 * Shared high-speed caching with Swoole-Table implementation.
 * 
 * @var boolean
 */
public $fastCache = true;

/**
 * Buerner Swoole-Table Driver Settings
 * 
 * @var string[]
 */
public $fastCacheConfig = [
    //Number of rows of the burner cache table
    'tableSize' =&gt; 4096,   
    //Key/value key Maximum length of string
    'keyLength' =&gt; 1024,
    //The maximum length of the key/value (if the save type is object, array, string).
    'valueStringLength' =&gt; 1024
];
</code></pre>
<p>Add the following settings to the <code>app/Config/Cache.php</code> configuration.</p>
<pre><code class="language-php">public $validHandlers = [
    //hide
    'burner' =&gt; \Monken\CIBurner\BurnerCacheHandler::class
];
</code></pre>
<p>Finally, you need to switch from <code>Primary Handler</code> to <code>Burner</code>.</p>
<pre><code class="language-php">public $handler = 'burner';
</code></pre>
<p>Now you can operate the <a href="https://www.codeigniter.com/user_guide/libraries/caching.html">Cache Library</a> in the same way as the Burner provided Swoole-Table Cache. Please note that Swoole-Table will lose all data due to server restart, it is just a solution to share data between workers.</p>
<h2 id="automatic-reload">Automatic reload</h2>
<p>By default, in the OpenSwoole state, you must restart the server after each modification to the PHP file to make your changes effective. This does not seem very friendly.</p>
<p>You can modify the <code>app/Config/OpenSwoole.php</code> configuration file and add the following settings and restart the server.</p>
<pre><code class="language-php">/**
 * Auto-scan changed files
 *
 * @var bool
 */
public $autoReload = true;

/**
 * Auto Reload Mode
 *
 * @var string restart or reload
 */
public $autoReloadMode = 'restart';
</code></pre>
<p>Burner provides two ways to reload, you can switch by adjusting <code>autoReloadMode</code>.</p>
<ul>
<li><code>restart</code> means that the server will automatically restart every time the file is changed. Just like you turn off the server yourself and then restart it, this can ensure that all php files are reloaded.</li>
<li><code>reload</code> will only reload the running Worker, just like the <a href="https://openswoole.com/docs/modules/swoole-server-reload#hot-code-linux-signal-trigger">document</a> says. Please note that this mode may not handle all cases. For example: When you make changes to the core PHP files of your project through <code>composer require/update</code>.</li>
</ul>
<div class="callout info"><p class="callout-title">Note</p>
<p><code>Automatic reload</code> method is very resource-intensive, please do not enable this option in the production environment.</p>
</div><h2 id="debugging-with-only-one-worker">Debugging with only one Worker</h2>
<p>Since OpenSwoole is fundamentally different from other server software (such as Nginx, Apache), each Codeigniter4 exists as a Worker in RAM, and HTTP requests reuse these Workers to handle them. Therefore, we develop and test the stability in the environment with only one Worker to prove that it can also run normally in the formal environment with multiple Workers.</p>
<p>You can refer to the following settings in the <code>app/Config/OpenSwoole.php</code> configuration file and reduce the number of Workers to the minimum:</p>
<pre><code class="language-php">public $config = [
    'worker_num' =&gt; 1,
    /** hide */
];
</code></pre>

            </div>
            <div class='sidebar-right'>
                <div class='page-nav' id='page-nav'>
                    <p class='page-nav-header'>On this page</p>
                    <ul>
                        
                        <li class='page-nav-level-1'>
                            <a href='#openswoole-suggestions'>OpenSwoole suggestions</a>
                        </li>
                        
                        <li class='page-nav-level-2'>
                            <a href='#fast-cache'>Fast Cache</a>
                        </li>
                        
                        <li class='page-nav-level-2'>
                            <a href='#automatic-reload'>Automatic reload</a>
                        </li>
                        
                        <li class='page-nav-level-2'>
                            <a href='#debugging-with-only-one-worker'>Debugging with only one Worker</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
            <div class='wave-container'>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                    <path fill-opacity="0.35"
                        d="M0,192L60,213.3C120,235,240,277,360,277.3C480,277,600,235,720,192C840,149,960,107,1080,122.7C1200,139,1320,213,1380,250.7L1440,288L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                    <path fill-opacity="0.5"
                        d="M0,160L60,181.3C120,203,240,245,360,229.3C480,213,600,139,720,138.7C840,139,960,213,1080,229.3C1200,245,1320,203,1380,181.3L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                    <path fill-opacity="0.2"
                        d="M0,224L60,197.3C120,171,240,117,360,117.3C480,117,600,171,720,186.7C840,203,960,181,1080,186.7C1200,192,1320,224,1380,240L1440,256L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
                    </path>
                </svg>
                <p>Powered by <a href='https://cli.doctave.com' target='_blank'>Doctave</a></p>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="/en/assets/katex.js?v=1679820075"></script>
    <script type="text/javascript" src="/en/assets/mermaid.js?v=1679820075"></script>
    <script type="text/javascript" src="/en/assets/elasticlunr.js?v=1679820075"></script>
    <script type="text/javascript" src="/en/assets/prism.js?v=1679820075"></script>
    <script type="text/javascript" src="/en/assets/doctave-app.js?v=1679820075"></script>

    
</body>

</html>